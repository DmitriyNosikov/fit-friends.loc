# Как работать над проектом

## :scroll: Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлена **Node.js**, соответствующая актуальной версии. Актуальная версия **Node.js** указана в файле `package.json` в поле `node`. 
После, в терминале, перейти в корневую директорию с проектом и _единожды_ запустите команду:

```bash
npm install
```

Данная команда запустит процесс установки зависимостей проекта из **npm**.

Проект разбит на 2 рабочих пространства: `server` и `client`. Перед началом работы необходимо настроить оба рабочих пространства.

### :arrow_forward: Server
Для подготовки серверной части, в первую очередь проверьте в директории сервера `/server` наличие `.env` файла со всеми необходимыми переменными среды.

Если такового нет, его необходимо создать и установить все соответствующие значения.

Пример с установленными переменными представлен в файле `.env-example`.

##### :page_facing_up: Доступные переменные окружения:
`HOST` = 127.0.0.1 - Хост, на котором размещен сервер
`PORT` = 8000 - Порт, на котором размещен сервер

##### POSTGRES
`POSTGRES_USER` = admin - PostgreSQL логин пользователя
`POSTGRES_PASSWORD`= admin  - PostgreSQL пароль пользователя
`POSTGRES_DB_NAME`= fit-friends - PostgreSQL название базы данных
`POSTGRES_PORT`= 5432  - PostgreSQL порт

`PGADMIN_DEFAULT_EMAIL` = admin@fit-friends.loc - PostgreSQL UI логин пользователя
`PGADMIN_DEFAULT_PASSWORD` = admin - PostgreSQL UI пароль пользователя
`PGADMIN_DEFAULT_PORT` = 8082 - PostgreSQL UI порт

##### JWT
`JWT_ACCESS_TOKEN_SECRET` = JP&^IOJD0h98nfdo(&) - Секретный ключ для формирования JWT-токена
`JWT_ACCESS_TOKEN_EXPIRES_IN` = 15m - Время жизни JWT-токена
`JWT_REFRESH_TOKEN_SECRET` = HLDgfh0924B)(*&g3)  - Секретный ключ для формирования REFRESH-токена
`JWT_REFRESH_TOKEN_EXPIRES_IN` = 7d - Время жизни REFRESH-токена

##### FILES
`UPLOAD_DIRECTORY_PATH` = /home/deimon/dev/fit-friends.loc/server/src/app/uploads - Директория для загрузки файлов
`STATIC_SERVE_ROOT` = /static - URL для раздачи статики

#
#### :high_brightness: Конфигурация Docker для работы приложения

Перейдите в директорию с серверной частью проекта `/server` и последовательно запустите следующие команды:

```bash
npm run docker:compose
```
Данная команда подготовит для серверной части соответствующий `docker-container`

#
#### :high_brightness: Подготовка базы данных
Далее необходимо подготовить к работе базу данных. Для этого выполните следующие команды:

```bash
npm run pg:rebuild
```
или последовательно команды:

```bash
npm run pg:migrate
```
```bash
npm run pg:generate
```
Данная команда запустит миграции и сгенерирует `Prisma Client` для работы с `PoestgreSQL`.

#
Для базы данных подготовлена процедура `"Сидирования"` (заполнения базы тестовыми данными).

Сидирование выполняется командой:
```bash
npm run pg:fill
```
Очистка и повторное заполнение базы данных:
```bash
npm run pg:refill
```

#
#### :high_brightness: Запуск сервера
После выполнения данных процедур серверная часть готова к работе.
Для запуска сервера выполните команду:

`WATCH-mode:`
```bash
npm run start:dev
```

`Prod-mode:`
```bash
npm run start
```

### :arrow_forward: Client
Клиентская часть не требует какой-либо специализированной подготовки.
Для ее работы достаточно перейти в директорию клиентской части `/client` и выполнить команду:

```bash
npm run start
```



## :bookmark_tabs: Структура проекта

### Директория `server`

В данной директории размещены файлы серверной части проекта

### Директория `client`

В данной директории размещены файлы клиентской части проекта

### Директория `shared`

В данной директории размещены общедоступные для серверной и клиентской части файлы

### Остальное

Все остальные файлы в проекте являются служебными. Пожалуйста, не удаляйте и не изменяйте их самовольно. Это может привести к полной неработоспособности проекта.